"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6480],{7739:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>t,metadata:()=>d,toc:()=>v});var i=n(4848),r=n(8453);const t={},o=void 0,d={id:"\u865a\u62df\u673a/1.1kvm\u57fa\u7840\u547d\u4ee4",title:"1.1kvm\u57fa\u7840\u547d\u4ee4",description:"kvm\u6587\u4ef6\u4f4d\u7f6e",source:"@site/ail_basis/2-\u865a\u62df\u673a/1.1kvm\u57fa\u7840\u547d\u4ee4.md",sourceDirName:"2-\u865a\u62df\u673a",slug:"/\u865a\u62df\u673a/1.1kvm\u57fa\u7840\u547d\u4ee4",permalink:"/node_docs_docusaurus_temp/ailbasis/\u865a\u62df\u673a/1.1kvm\u57fa\u7840\u547d\u4ee4",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/ail_basis/2-\u865a\u62df\u673a/1.1kvm\u57fa\u7840\u547d\u4ee4.md",tags:[],version:"current",lastUpdatedBy:"\u201cAiluntz\u201d",lastUpdatedAt:1727340015e3,frontMatter:{},sidebar:"ailbasis",previous:{title:"\u91cd\u88c5\u7cfb\u7edf",permalink:"/node_docs_docusaurus_temp/ailbasis/\u7cfb\u7edf/\u91cd\u88c5\u7cfb\u7edf"},next:{title:"1.1kvm\u7cfb\u7edf\u5b89\u88c5",permalink:"/node_docs_docusaurus_temp/ailbasis/\u865a\u62df\u673a/1.1kvm\u7cfb\u7edf\u5b89\u88c5"}},c={},v=[{value:"kvm\u6587\u4ef6\u4f4d\u7f6e",id:"kvm\u6587\u4ef6\u4f4d\u7f6e",level:3},{value:"kvm\u4e00\u952e\u5220\u9664\u865a\u62df\u673a",id:"kvm\u4e00\u952e\u5220\u9664\u865a\u62df\u673a",level:3},{value:"kvm\u57fa\u672c\u547d\u4ee4",id:"kvm\u57fa\u672c\u547d\u4ee4",level:3},{value:"kvm\u5feb\u901f\u514b\u9686\u5bb9\u5668",id:"kvm\u5feb\u901f\u514b\u9686\u5bb9\u5668",level:3},{value:"kvm\u514b\u9686\u5bb9\u5668\u540e\u4fee\u6539\u7aef\u53e3",id:"kvm\u514b\u9686\u5bb9\u5668\u540e\u4fee\u6539\u7aef\u53e3",level:3},{value:"\u4fee\u6539\u865a\u62df\u673a\u914d\u7f6e\u6587\u4ef6",id:"\u4fee\u6539\u865a\u62df\u673a\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u5feb\u7167\u7ba1\u7406",id:"\u5feb\u7167\u7ba1\u7406",level:3},{value:"\u6269\u5bb9",id:"\u6269\u5bb9",level:3},{value:"\u5176\u4ed6\u8bf4\u660e",id:"\u5176\u4ed6\u8bf4\u660e",level:3}];function l(e){const s={code:"code",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h3,{id:"kvm\u6587\u4ef6\u4f4d\u7f6e",children:"kvm\u6587\u4ef6\u4f4d\u7f6e"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"/etc/libvirt/qemu #\u914d\u7f6e\u6587\u4ef6\n/var/lib/libvirt/images/ #\u78c1\u76d8\u955c\u50cf\n"})}),"\n",(0,i.jsx)(s.h3,{id:"kvm\u4e00\u952e\u5220\u9664\u865a\u62df\u673a",children:"kvm\u4e00\u952e\u5220\u9664\u865a\u62df\u673a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"virsh shutdown vm #\u5173\u95ed\u865a\u62df\u673a\nvirsh destroy vm   #\u5f3a\u5236\u65ad\u7535\nvirsh undefine vm  #\u79fb\u9664\u914d\u7f6e\u4fe1\u606f\nrm /home/iso/vm.qcow2   #\u79fb\u9664\u78c1\u76d8\n"})}),"\n",(0,i.jsx)(s.h3,{id:"kvm\u57fa\u672c\u547d\u4ee4",children:"kvm\u57fa\u672c\u547d\u4ee4"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"sudo virsh edit vm1\nvirsh list --all //\u5217\u51fa\u6240\u6709\u865a\u62df\u673a\nvirsh start vm1     # \u865a\u62df\u673a\u5f00\u542f\uff08\u542f\u52a8\uff09\uff1a\nvirsh reboot centos7-1    # \u865a\u62df\u673a\u91cd\u65b0\u542f\u52a8\nvirsh shutdown vm31  # \u865a\u62df\u673a\u5173\u673a\nvirsh destroy centos7-1   # \u5f3a\u5236\u5173\u673a\uff08\u5f3a\u5236\u65ad\u7535\uff09\nvirsh suspend centos7-1   # \u6682\u505c\uff08\u6302\u8d77\uff09KVM \u865a\u62df\u673a\nvirsh resume centos7-1    # \u6062\u590d\u88ab\u6302\u8d77\u7684 KVM \u865a\u62df\u673a\nvirsh undefine centos7-1  # \u8be5\u65b9\u6cd5\u53ea\u5220\u9664\u914d\u7f6e\u6587\u4ef6\uff0c\u78c1\u76d8\u6587\u4ef6\u672a\u5220\u9664\nvirsh autostart centos7-1 # \u968f\u7269\u7406\u673a\u542f\u52a8\u800c\u542f\u52a8\uff08\u5f00\u673a\u542f\u52a8\uff09\nvirsh autostart --disable centos7-1 # \u53d6\u6d88\u6807\u8bb0\u4e3a\u81ea\u52a8\u5f00\u59cb\uff08\u53d6\u6d88\u5f00\u673a\u542f\u52a8\uff09\n"})}),"\n",(0,i.jsx)(s.h3,{id:"kvm\u5feb\u901f\u514b\u9686\u5bb9\u5668",children:"kvm\u5feb\u901f\u514b\u9686\u5bb9\u5668"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"virt-clone -o vm31 -n vm32 --auto-clone\n"})}),"\n",(0,i.jsx)(s.h3,{id:"kvm\u514b\u9686\u5bb9\u5668\u540e\u4fee\u6539\u7aef\u53e3",children:"kvm\u514b\u9686\u5bb9\u5668\u540e\u4fee\u6539\u7aef\u53e3"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"sudo virsh edit vm32\ntype=vnc  autoport= no \u4fee\u6539\u7aef\u53e3\u548cautoport\nvirsh start vm32\nvnc://192.168.8.16:5990\n"})}),"\n",(0,i.jsx)(s.h3,{id:"\u4fee\u6539\u865a\u62df\u673a\u914d\u7f6e\u6587\u4ef6",children:"\u4fee\u6539\u865a\u62df\u673a\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,i.jsx)(s.p,{children:"vim /etc/libvirt/qemu/vm3.xml"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"\u865a\u62df\u673a\u540d\u79f0\uff1a<name>vm2</name>\nuuid\uff1a<uuid>d0bc50b6-6acc-432b-9953-bc47b2b4aa87</uuid>\n\u78c1\u76d8\u955c\u50cf\u6587\u4ef6\u540d\u79f0\uff1a<source file='/var/lib/libvirt/images/vm2.qcow2'/>\nmac\u5730\u5740\uff1a<mac address='52:54:00:04:63:6a'/>\nsudo virsh edit vm1 \n"})}),"\n",(0,i.jsx)(s.h3,{id:"\u5feb\u7167\u7ba1\u7406",children:"\u5feb\u7167\u7ba1\u7406"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"virsh snapshot-create-as sriov-1 sriov-1-s1  //\u4e3a\u865a\u62df\u673asriov-1\u521b\u5efa\u5feb\u7167sriov-1-s1\nvirsh snapshot-list sriov-1 //\u5217\u51fa\u865a\u62df\u673atest1\u7684\u6240\u6709\u5feb\u7167\nvirsh snapshot-info sriov-1 sriov-1-s1 //\u67e5\u770b\u5feb\u7167\u7684\u8be6\u7ec6\u4fe1\u606f\nvirsh snapshot-delete sriov-1sriov-1-s1 //\u5220\u9664\u865a\u62df\u673asriov-1\u7684\u5feb\u7167sriov-1-s1\nvirsh snapshot-revert centos7-5 centos7-5-s1 #\u6062\u590d\u5feb\u7167\n"})}),"\n",(0,i.jsx)(s.h3,{id:"\u6269\u5bb9",children:"\u6269\u5bb9"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"qemu-img resize /home/iso/vm2.qcow2 100G\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"df -h  #\u67e5\u770b\u7ed3\u679c\nlsblk\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u8fdb\u5165\u5bb9\u5668\u6269\u5c55\u5206\u533a"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"sudo apt update\nsudo apt install cloud-guest-utils\nsudo growpart /dev/vda 3\nsudo resize2fs /dev/vda3\n"})}),"\n",(0,i.jsx)(s.p,{children:"\u9a8c\u8bc1\u6269\u5c55"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"df -h\n"})}),"\n",(0,i.jsx)(s.h3,{id:"\u5176\u4ed6\u8bf4\u660e",children:"\u5176\u4ed6\u8bf4\u660e"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"raw \u539f\u59cb\u683c\u5f0f\uff0c\u6027\u80fd\u6700\u597d\u3002\u76f4\u63a5\u5206\u914d\u6307\u5b9a\u7684\u7a7a\u95f4\u3002raw\u4e0d\u652f\u6301\u5feb\u7167\nqcow2 \u6027\u80fd\u4e0a\u8fd8\u662f\u4e0d\u5982raw\uff0cqcow2\u652f\u6301\u5feb\u7167\u3002\u7528\u591a\u5c11\u7a7a\u95f4\u5206\u914d\u591a\u5c11\u7a7a\u95f4\u3002\n\u9ed8\u8ba4\u5b89\u88c5\u597d\u7684\u7528\u7684\u662fraw\u683c\u5f0f\uff0c\u505a\u5feb\u7167\u8981\u628a\u4ed6\u8f6c\u6362\u6210qcow2\u683c\u5f0f\nqemu-img convert -f raw -O qcow2 /var/lib/libvirt/images/rhel5u8-1.img /var/lib/libvirt/images/rhel5u8-1_qcow2.img\n\u5efa\u7acbqcow2\u683c\u5f0f\u78c1\u76d8\u6587\u4ef6:qemu-img create -f qcow2 test.qcow2 20G\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 -f\u6307\u5b9a\u683c\u5f0f\n\u5efa\u7acbraw\u683c\u5f0f\u78c1\u76d8\u6587\u4ef6:\xa0\xa0qemu-img create -f raw test.raw 20G\xa0\xa0\xa0\xa0\xa0\xa0 \u5927\u5c0f20G\n\u67e5\u770b\u5df2\u7ecf\u521b\u5efa\u7684\u865a\u62df\u78c1\u76d8\u6587\u4ef6:\xa0 qemu-img info test.qcow2\n"})})]})}function a(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>d});var i=n(6540);const r={},t=i.createContext(r);function o(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);